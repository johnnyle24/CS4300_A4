function action = CS4300_Hybrid_Wumpus_Agent(percept)
import java.util.Queue;
% CS4300_Hybrid_Wumpus_Agent - KB logic agent 
%    
% On input:
%     percept (1x5 Boolean vector): percept values
%      (1): Stench
%      (2): Pit
%      (3): Glitters
%      (4): Bumped
%      (5): Screamed
% On output:
%     action (int): action selected by agent
%       FORWARD = 1;
%       ROTATE_RIGHT = 2;
%       ROTATE_LEFT = 3;
%       GRAB = 4;   
%       SHOOT = 5;  
%       CLIMB = 6;  
% Call:
%     a = CS4300_Example1([0,1,0,0,0]);
% Author:
%     T. Henderson
%     UU
%     Summer 2015
%

%Type
%0 Pits
%1 Breeze
%2 Stench
%3 Wumpus

%Pits [1,16]
%Breeze [17,32]
%Stench [33,48]
%Wumpus [49,65]

FORWARD = 1;
ROTATE_RIGHT = 2;
ROTATE_LEFT = 3;
GRAB = 4;
SHOOT = 5;
CLIMB = 6;

if(~exist(KB))
    global KB;
    %Initially no pit and no wumpus in 1,1
    KB = CS4300_Initialize_KB();
    
    persistent local_x;
    local_x = 1;
    
    persistent local_y;
    local_y = 1;
    
    persistent local_orientation;
    local_orientation = 0;
    
    persistent visited;
    visited(1).square = [1,1];
    
    persistent fringe_squares;
    fringe_squares(1).square = [1,2];
    fringe_squares(2).square = [2,1];
    
    persistent fringe_squares_index;
    fringe_squares_index = 1;
    
    persistent action;
    
    persistent plan;
    plan = Queue();
    
    persistent succeed;
    succeed = 0;
end

%update x,y orientation, visited, fringe_squares based on action

%if stench
if(percept(1))
    CS4300_Tell(KB, CS4300_Get_Index(x,y,1,2));
else
    CS4300_Tell(KB, CS4300_Get_Index(x,y,-1,2));
end

%if breeze
if(percept(2))
    CS4300_Tell(KB, CS4300_Get_Index(x,y,1,1));
else
    CS4300_Tell(KB, CS4300_Get_Index(x,y,-1,1));
end

%if glitter
if(percept(3))
   action = GRAB;
   succeed = 1;
   return;
   
%plan is non empty
elseif(~plan.isEmpty)
    action = plan.remove();
    return
end
       
%check fringe squares
%check (i,j) if(ask(kb, (-Pij A -Wij)) || !ask(kb, (Pij V Wij))
%then plan = A* search from (x,y) to (i,j)
%action = action.pop
    
square = fringe_squares(fringe_squares_index).square;
fringe_squares_index = fringe_squares_index + 1; %check valid index

pit_exist = CS4300_Get_Index(square(1),square(2),1,0);
pit_not_exist = CS4300_Get_Index(square(1),square(2),-1,0);
wumpus_exist = CS4300_Get_Index(square(1),square(2),1,3);
wumpus_not_exist = CS4300_Get_Index(square(1),square(2),-1,3);

sentence1(1).clause = pit_not_exist;
sentence1(2).clause = wumpus_not_exist;
sentence2(1).clause = pit_exist;
sentence2(2).clause = wumpus_exist;

if(CS4300_Ask(KB,sentence1) || ~CS4300_Ask(KB,sentence2))
   
        
else
    %action = random action
    x = randi([0, 2]);

    switch x
        case 0
            action = FORWARD;
        case 1
            action = ROTATE_RIGHT;
        case 2
            action = ROTATE_LEFT;
end


    
    
    
    
    







end

